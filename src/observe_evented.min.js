/*! Observe_evented 0.1.0 */
!function(a){var b,c,d={dropValues:!1,eventTypes:null,minimalEvents:!1,noArrayUpdate:!1},e=[];a.observe&&(b=a.observe),a.unobserve&&(c=a.unobserve);var f=function(b){var c;return a.each(e,function(a,d){return b===d.object?(c=a,!1):void 0}),void 0===c&&(c=e.length,e.push({object:b,observers:[]})),e[c].observers};a.observe=function(b,c,e,g){void 0===c?c=null:"object"==typeof c?(g=e||function(){},e=c,c=null):"function"==typeof c&&(g=c,e={},c=null),e?"function"==typeof e&&(g=e,e={}):e={},g||(g=function(){}),e=a.extend(!0,{},d,e);var h=function(d){if(a.each(d,function(c,d){if("splice"!==d.type){var f=a.extend(!0,{},d),g=[];k&&(f.name=parseInt(f.name)),"delete"===f.type&&(k?(f.type="update",f.value=null):f.type="remove"),k&&"update"===f.type&&e.noArrayUpdate?g.push({object:b,name:f.name,oldValue:f.oldValue,type:"remove"},{object:b,name:f.name,type:"add"}):g.push(f),Array.prototype.push.apply(i,g)}else{a.each(d.removed,function(a,c){var e=d.index,f={name:e,object:b,oldValue:c||null,type:"remove"};i.push(f)});for(var h=0;h<d.addedCount;h++){var j=d.index+h,f={name:j,object:b,type:"add"};i.push(f)}}}),!e.dropValues)for(var f=0;f<i.length;f++){var j=i[f];if(("add"===j.type||"update"===j.type)&&void 0===j.value)if(k){for(var l=j.name,m=f+1;m<i.length;m++){var n=i[m];if(l>n.name)"add"===n.type?l++:"remove"===n.type&&l--;else if(l===n.name)if("add"===n.type)l++;else if("update"===n.type||"remove"===n.type){j.value=n.oldValue;break}}void 0===j.value&&(j.value=b[l])}else{for(var m=f+1;m<i.length;m++){var n=i[m];if(j.name===n.name&&("update"===n.type||"remove"===n.type)){j.value=n.oldValue;break}}void 0===j.value&&(j.value=b[j.name])}}if(e.minimalEvents){var o;if(k){o=[];for(var f=0;f<i.length;f++){var j=i[f],p=null;"add"!==j.type&&a.each(o,function(a,b){return j.name===b[0][b[0].length-1]?(p=a,!1):void 0}),null===p&&(p=o.length,o.push([[],[]])),("add"===j.type||"remove"===j.type)&&a.each(o,function(a,b){if(b[0].length){var c=b[0][b[0].length-1];j.name<c?b[0].push("add"===j.type?c+1:c-1):j.name===c&&"add"===j.type&&b[0].push(c+1)}}),"add"===j.type||0===o[p][0].length?o[p][0].push(j.name):"remove"===j.type&&o[p][0].push(-1),o[p][1].push(f)}o=a.map(o,function(a){return a[0]=a[0].pop(),[a]})}else o={},a.each(i,function(a,b){o[b.name]||(o[b.name]=[]),o[b.name].push(a)}),o=a.map(o,function(a,b){return[[b,a]]});var q=[];a.each(o,function(b,c){var d=c[0],e=c[1],f=i[e[e.length-1]];if("remove"===f.type){if(e.length>1)if("add"===i[e[0]].type)a.each(e,function(a,b){q.push(b)});else for(var g=0;g<e.length-1;g++)q.push(e[g])}else{for(var g=1;g<e.length;g++)q.push(e[g]);k&&(i[e[0]].name=d)}}),i=a.grep(i,function(b,c){return-1===a.inArray(c,q)}),e.dropValues||a.each(i,function(a,c){("add"===c.type||"update"===c.type)&&(c.value=b[c.name])})}var r=a.merge([],i);r.unshift({object:b,type:"rawBatch",value:d}),r.unshift({object:b,type:"batch",value:i}),a.each(r,function(d,f){e.eventTypes&&-1===a.inArray(f.type,e.eventTypes)||(null===c||c===f.name)&&(g.call(b,f),h.$eventEmitter.trigger(f))})};h.$eventEmitter=a({object:b,name:c}),h.$eventEmitter.unobserve=function(){a.unobserve(b,h)},f(b).push(h);var i=[],j=void 0,k=a.isArray(b),l=k?Array:Object;return!k&&e.eventTypes&&(e.dropValues?(j=e.eventTypes,-1!==a.inArray("remove",j)&&j.push("delete")):(j=a.merge([],e.eventTypes),a.each(["add","update","delete"],function(b,c){-1===a.inArray(c,j)&&j.push(c)}))),l.observe(b,h,j,c),h.$eventEmitter},a.observe.defaultOptions=function(b){d=a.extend(!0,d,b)},a.observe.noConflict=function(d){d=d||"oe_",a[d+"observe"]=a.observe,a[d+"unobserve"]=a.unobserve,b&&(a.observe=b),c&&(a.observe=b)},a.unobserve=function(b,c){var d,e=f(b),g=a.isArray(b)?Array:Object;d=c?[c]:e,a.each(d,function(c,d){setTimeout(function(){d.$eventEmitter.off()},0),g.unobserve(b,d),e.splice(a.inArray(d,e),1)})}}(jQuery);