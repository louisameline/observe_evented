/*! Observe_evented 0.1.0 */
!function(a){var b,c,d={eventTypes:null,dropValues:!1},e=[];a.observe&&(b=a.observe),a.unobserve&&(c=a.unobserve);var f=function(b){var c;return a.each(e,function(a,d){return b===d.object?(c=a,!1):void 0}),void 0===c&&(c=e.length,e.push({object:b,observers:[]})),e[c].observers};a.observe=function(b,c,e,g){void 0===c?c=null:"object"==typeof c?(g=e||function(){},e=c,c=null):"function"==typeof c&&(g=c,e={},c=null),e?"function"==typeof e&&(g=e,e={}):e={},g||(g=function(){}),e=a.extend(!0,{},d,e);var h=function(d){if(a.each(d,function(c,d){if("splice"!==d.type){var e=a.extend(!0,{},d);k&&(e.name=parseInt(e.name)),"delete"===e.type&&(k?(e.type="update",e.value=null):e.type="remove"),i.push(e)}else{a.each(d.removed,function(a,c){var e=d.index+a,f={name:e,object:b,oldValue:c||null,type:"remove"};i.push(f)});for(var f=0;f<d.addedCount;f++){var g=d.index+f,e={name:g,object:b,type:"add"};i.push(e)}}}),!e.dropValues)for(var f=0;f<i.length;f++){var j=i[f];if(("add"===j.type||"update"===j.type)&&void 0===j.value)if(k){for(var l=j.name,m=f+1;m<i.length;m++){var n=i[m];if(l>n.name)"add"===n.type?l++:"remove"===n.type&&l--;else if(l===n.name)if("add"===n.type)l++;else if("update"===n.type||"remove"===n.type){j.value=n.oldValue;break}}void 0===j.value&&(j.value=b[l])}else{for(var m=f+1;m<i.length;m++){var n=i[m];if(j.name===n.name&&("update"===n.type||"remove"===n.type)){j.value=n.oldValue;break}}void 0===j.value&&(j.value=b[j.name])}}var o=a.merge([],i);o.unshift({type:"rawBatch",value:d}),o.unshift({type:"batch",value:i}),a.each(o,function(d,f){e.eventTypes&&-1===a.inArray(f.type,e.eventTypes)||(null===c||c===f.name)&&(g.call(b,f),h.$eventEmitter.trigger(f))})};h.$eventEmitter=a({object:b,name:c}),h.$eventEmitter.unobserve=function(){a.unobserve(b,h)},f(b).push(h);var i=[],j=void 0,k=a.isArray(b),l=k?Array:Object;return!k&&e.eventTypes&&(e.dropValues?(j=e.eventTypes,-1!==a.inArray("remove",j)&&j.push("delete")):(j=a.merge([],e.eventTypes),a.each(["add","update","delete"],function(b,c){-1===a.inArray(c,j)&&j.push(c)}))),l.observe(b,h,j,c),h.$eventEmitter},a.observe.defaultOptions=function(b){d=a.extend(!0,d,b)},a.observe.noConflict=function(d){d=d||"oe_",a[d+"observe"]=a.observe,a[d+"unobserve"]=a.unobserve,b&&(a.observe=b),c&&(a.observe=b)},a.unobserve=function(b,c){var d,e=f(b),g=a.isArray(b)?Array:Object;d=c?[c]:e,a.each(d,function(c,d){setTimeout(function(){d.$eventEmitter.off()},0),g.unobserve(b,d),e.splice(a.inArray(d,e),1)})}}(jQuery);